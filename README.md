# –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
- [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–í–ê–ñ–ù–û](#–≤–∞–∂–Ω–æ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞zip_verifier](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞zip_verifier)
- [API](#api)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
  - [–¢–∞–±–ª–∏—Ü—ã](#—Ç–∞–±–ª–∏—Ü—ã)
    - [–¢–∞–±–ª–∏—Ü–∞ `task_results`](#—Ç–∞–±–ª–∏—Ü–∞-task_results)
      - [–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `status`:](#–≤–æ–∑–º–æ–∂–Ω—ã–µ-–∑–Ω–∞—á–µ–Ω–∏—è-status)
  - [–°—Ö–µ–º—ã](#—Å—Ö–µ–º—ã)
    - [`UploadResponse`](#uploadresponse)
    - [`TestResults`](#testresults)
    - [`ResultsResponse`](#resultsresponse)
  - [–ú–∏–≥—Ä–∞—Ü–∏–∏ (alembic)](#–º–∏–≥—Ä–∞—Ü–∏–∏-alembic)
    - [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
    - [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ—Ü–µ—Å—Å–∞-–º–∏–≥—Ä–∞—Ü–∏–π)
- [–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ)
  - [–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞](#–∑–∞–ø—É—Å–∫-–ø—Ä–æ–µ–∫—Ç–∞)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã](#–æ–±—â–∏–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
  - [–ü–æ–ª—É—á–∏–ª–æ—Å—å](#–ø–æ–ª—É—á–∏–ª–æ—Å—å)
  - [–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å](#–Ω–µ-–ø–æ–ª—É—á–∏–ª–æ—Å—å)

# –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é ZIP-–∞—Ä—Ö–∏–≤–æ–≤, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å MinIO –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –≤–Ω–µ—à–Ω–∏–º API. –í –∫–∞—á–µ—Å—Ç–≤–µ –∫—ç—à–∞ –∏ –±—Ä–æ–∫–µ—Ä–∞ –¥–ª—è Celery –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

- –ó–∞–≥—Ä—É–∑–∫–∞ ZIP-–∞—Ä—Ö–∏–≤–∞ (POST /upload) —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ö—ç—à-—Å—É–º–º—ã
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏–≤–∞ —Å —ç–º—É–ª—è—Ü–∏–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –≤–Ω–µ—à–Ω–∏–º API
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ (GET /results/{task_id})
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–¥–∞—á–∞—Ö
- –•—Ä–∞–Ω–µ–Ω–∏–µ ZIP-–∞—Ä—Ö–∏–≤–æ–≤ –≤ MinIO
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á Celery + Redis
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Redis

# –í–ê–ñ–ù–û

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞—Ä—Ö–∏–≤–æ–≤ –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫–∞. –û–Ω–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ –Ω–∏ —Å —á–µ–º –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤ `external_apis.py`, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–¥–∞—á–∏ –≤ –±–¥. –ü–æ—Å–∫–æ–ª—å–∫—É Celery –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Å–ª—É—á–∞–µ –µ—ë –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - —á–µ—Ä–µ–∑ 180 —Å–µ–∫—É–Ω–¥ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏–≤–∞ –≤–æ –≤–Ω–µ—à–Ω–∏—Ö api.

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞zip_verifier

```text
‚îú üìÇ app - –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ ‚îú üìÇ api - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ FastAPI
‚îÇ ‚îÇ ‚îú routers.py - –Ω–∞–±–æ—Ä —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îÇ ‚îÇ ‚îî schemas.py - —Å—Ö–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ ‚îÇ
‚îÇ ‚îú üìÇ db - –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îÇ ‚îú base.py - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –º–æ–¥–µ–ª–µ–π
‚îÇ ‚îÇ ‚îî session.py - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îÇ
‚îÇ ‚îú üìÇ models - –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π SQLAlchemy
‚îÇ ‚îÇ ‚îî task_result.py - –º–æ–¥–µ–ª—å –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—Ä—Ö–∏–≤–∞
‚îÇ ‚îÇ
‚îÇ ‚îú üìÇ services - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Celery, MinIO, –≤–Ω–µ—à–Ω–∏–µ api)
‚îÇ ‚îÇ ‚îú celery.py - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –º –∑–∞–¥–∞—á celery
‚îÇ ‚îÇ ‚îî minio_client.py - —Ä–∞–±–æ—Ç–∞ —Å minio –∫–ª–∏–µ–Ω—Ç–æ–º
‚îÇ ‚îÇ
‚îÇ ‚îú main.py - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ ‚îú config.py - —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ ‚îî check_hash.py - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–æ–≤
‚îÇ
‚îú üìÇ external_api - mock —Å–µ—Ä–≤–∏—Å—ã, —ç–º—É–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∞—Ä—Ö–∏–≤–∞
‚îÇ ‚îú coverage.py - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∏ –±–∞–≥–æ–≤
‚îÇ ‚îú smells.py - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∞—Ö–æ–≤ –∫–æ–¥–∞
‚îÇ ‚îî vulnerabilities.py - –ø–æ–ª—É—á–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
‚îÇ
‚îú üìÇ migrations - –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
‚îÇ ‚îú üìÇ versions/ - —Ñ–∞–π–ª—ã —Å –≤–µ—Ä—Å–∏—è–º–∏ –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ ‚îú script.py.mako - —à–∞–±–ª–æ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ ‚îî env.py - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª Alembic
‚îÇ
‚îú üìÇ tests - —Ç–µ—Å—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îú .env - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú .gitignore - —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö Git
‚îú alembic.ini - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª Alembic –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
‚îú docker-compose.yml - —Ñ–∞–π–ª –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ Docker
‚îú Dockerfile - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú poetry.lock - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Poetry
‚îú pyproject.toml - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Poetry
‚îî README.md - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

# API

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç.–∑. –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL.

## –¢–∞–±–ª–∏—Ü—ã

### –¢–∞–±–ª–∏—Ü–∞ `task_results`

–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–∞—á–∞—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö ZIP-–∞—Ä—Ö–∏–≤–æ–≤.

| –ü–æ–ª–µ    | –¢–∏–ø                                            | –û–ø–∏—Å–∞–Ω–∏–µ                         |
| ------- | ---------------------------------------------- | -------------------------------- |
| task_id | `STRING (PRIMARY KEY)`                         | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞—á–∏. |
| status  | `ENUM (PENDING, IN_PROGRESS, SUCCESS, FAILED)` | –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏.           |
| results | `JSONB (nullable)`                             | –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–µ—Ç—Ä–∏–∫–∏).   |

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `status`:

- **PENDING** ‚Äì –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞.
- **IN_PROGRESS** ‚Äì –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.
- **SUCCESS** ‚Äì –∑–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
- **FAILED** ‚Äì –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–î–∞–Ω–Ω—ã–µ –∏–∑ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö ZIP-–∞—Ä—Ö–∏–≤–æ–≤ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –í –∫–æ–¥–µ `task_id` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ hash –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞.

## –°—Ö–µ–º—ã

### `UploadResponse`

–û—Ç–≤–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ZIP-–∞—Ä—Ö–∏–≤–∞.

| –ü–æ–ª–µ    | –¢–∏–ø   | –û–ø–∏—Å–∞–Ω–∏–µ                         |
| ------- | ----- | -------------------------------- |
| task_id | `str` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞—á–∏. |

---

### `TestResults`

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ ZIP-–∞—Ä—Ö–∏–≤–∞.

| –ü–æ–ª–µ             | –¢–∏–ø              | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ---------------- | ---------------- | --------------------------------------- |
| overall_coverage | `float`          | –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏.    |
| bugs             | `Dict[str, int]` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.        |
| code_smells      | `Dict[str, int]` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ "Code Smells" –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. |
| vulnerabilities  | `Dict[str, int]` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.   |

---

### `ResultsResponse`

–û—Ç–≤–µ—Ç API —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.

| –ü–æ–ª–µ    | –¢–∏–ø                     | –û–ø–∏—Å–∞–Ω–∏–µ                                          |
| ------- | ----------------------- | ------------------------------------------------- |
| status  | `TaskStatusEnum`        | –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ (PENDING, SUCCESS –∏ —Ç. –¥.). |
| results | `Optional[TestResults]` | –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å).          |

- –ï—Å–ª–∏ `status` = `PENDING` –∏–ª–∏ `IN_PROGRESS`, –ø–æ–ª–µ `results` –±—É–¥–µ—Ç `null`.
- –ï—Å–ª–∏ `status` = `SUCCESS`, –ø–æ–ª–µ `results` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞.
- –ï—Å–ª–∏ `status` = `FAILED`, `results` –±—É–¥–µ—Ç `null`.

## –ú–∏–≥—Ä–∞—Ü–∏–∏ (alembic)

Alembic –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Ö –≤ –≤–∏–¥–µ –≤–µ—Ä—Å–∏–π –º–∏–≥—Ä–∞—Ü–∏–π.

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–í —Ñ–∞–π–ª–µ .env –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∞–¥—Ä–µ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –º–∏–≥—Ä–∞—Ü–∏–∏, –≤ –º–µ—Ä–µ–º–µ–Ω–Ω–æ–π DATABASE_URL.
**–ü—Ä–∏–º–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ docker-compose**

```ini
DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@zip-veryfier-postgres:5432/${POSTGRES_DB}
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Å—Ä–µ–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è**

```ini
DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:5432/${POSTGRES_DB}
```

–í —Å–ª—É—á–∞ –∑–∞–º–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é DATABASE_URL –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏.

### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π

1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏**
   ```bash
   poetry run alembic revision --autogenerate -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   ```
2. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è**
   ```bash
   poetry run alembic upgrade head
   ```
3. **–û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏**
   ```bash
   poetry run alembic downgrade -1
   ```

# –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

–î–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç—å—Å—è, —á—Ç–æ –≤ —Ñ–∞–π–ª–∞—Ö `.env` –∏ `docker-compose.yml` –∑–∞–¥–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω–∏–ª–∏—â—É MinIO –∏ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ:

- –í `.env` –∑–∞–¥–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (`DATABASE_URL`), MinIO (`MINIO_ROOT_USER`, `MINIO_ROOT_PASSWORD`).
- –í `docker-compose.yml` —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `.env` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ docker-compose

```bash
# PostgreSQL
POSTGRES_DB=zip_verifier
POSTGRES_USER=zip_admin
POSTGRES_PASSWORD=supersecurepassword

# MinIO
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadminpassword
MINIO_BUCKET_NAME=zip-archives

# Keycloak
KC_ADMIN=admin
KC_ADMIN_PASSWORD=adminpassword

# FastAPI
MINIO_ENDPOINT=minio:9000
DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@zip_verifier_postgres:5432/${POSTGRES_DB}

# Celery
CELERY_BROKER_URL=redis://zip_verifier_redis:6379/0
```

–ü—Ä–∏–º–µ—Ä docker-compose:

```yaml
networks:
  zip_verifier_network:
    driver: bridge

services:
  postgres:
    image: postgres:16
    container_name: zip_verifier_postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${POSTGRES_DB}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - zip_verifier_network

  minio:
    image: minio/minio:latest
    container_name: zip_verifier_minio
    restart: unless-stopped
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
    ports:
      - "9000:9000"
      - "9001:9001"
    command: server --address 0.0.0.0:9000 --console-address 0.0.0.0:9001 /data
    volumes:
      - minio_data:/data
    networks:
      - zip_verifier_network

  redis:
    image: redis:7
    container_name: zip_verifier_redis
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - zip_verifier_network

  alembic:
    build: .
    container_name: zip_verifier_alembic
    restart: on-failure:5
    env_file: .env
    depends_on:
      - postgres
    command: >
      poetry run alembic upgrade head
    networks:
      - zip_verifier_network

  fastapi:
    build: .
    container_name: zip_verifier_fastapi
    restart: unless-stopped
    env_file: .env
    depends_on:
      alembic:
        condition: service_completed_successfully
      redis:
        condition: service_started
      minio:
        condition: service_started
    ports:
      - "8000:8000"
    command: >
      poetry run uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    networks:
      - zip_verifier_network

  celery:
    build: .
    container_name: zip_verifier_celery
    restart: unless-stopped
    env_file: .env
    depends_on:
      fastapi:
        condition: service_started
      redis:
        condition: service_started
    command: >
      poetry run celery -A app.services.celery worker -l info -P eventlet
    networks:
      - zip_verifier_network

volumes:
  postgres_data:
  minio_data:
  redis_data:
```

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
docker-compose -p zip_tester up --build -d
```

–î–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –∏—Ö –≤—ã–∫–ª—é—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É

```bash
docker-compose --project_name zip_tester down -v
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ—Å—Ç—É–ø –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º fastapi –æ—Å—É—â—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8000/docs`.

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤ –æ—Å—É–∑–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π

```
poetry pytest tests
```

# –û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## –ü–æ–ª—É—á–∏–ª–æ—Å—å

- —Å–¥–µ–ª–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –¥–æ–±–∞–≤–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- —Å–¥–µ–ª–∞—Ç—å —Ñ–æ–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á
- —Å–¥–µ–ª–∞—Ç—å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ docker-compose
- –¥–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
- —Å–¥–µ–ª–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- —Å–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## –ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å

- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å–µ—Å—Å–∏—é –≤–º–µ—Å—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ 2-—Ö —à—Ç—É–∫ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ª–æ–º–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å fastapi, –∞ –ø—Ä–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –ª–æ–º–∞–µ—Ç—Å—è celery)
- —Å–¥–µ–ª–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ keycloak (–≤ –¥–æ–∫–µ—Ä–µ –≤—Å—ë –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, keycloak —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ–∏ —Ç–∞–±–ª–∏—á–∫–∏ –≤ postgres-–µ, —è —Ä—É—á–∫–∞–º–∏ —Å–æ–∑–¥–∞—é realm –∏ user, –Ω–æ –æ–Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –Ω–µ–ª—å–∑—è –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –ø–æ —ç—Ç–æ–º—É –∞–¥—Ä–µ—Å—É. –ü—ã—Ç–∞–ª—Å—è —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ –¥—Ä—É–≥—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –Ω–æ —Ç–∞–º –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–∏–º–µ—Ä —Å keycloak 16 –≤–µ—Ä—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–∫–µ—Ä –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∫–∞—á–∏–≤–∞—Ç—å)
- —Å–¥–µ–ª–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å api - service - repository (—Å–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–ª —Ç–µ—Å—Ç—ã, –∞ –ø–æ—Ç–æ–º —É–≤–∏–¥–µ–ª –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –µ—Å–ª–∏ –µ—ë –ø–æ–º–µ–Ω—è—Ç—å - —É–ø–∞–¥—É—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã)
- —Å–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ fastapi Backgroundtasks (–æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π –æ–∫–∞–∑–∞–ª–∞—Å—å –ø–µ—Ä–µ–¥–∞—á–∞ —Å–µ—Å—Å–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ task. –ï—Å–ª–∏ –¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤ –º–∞—Ä—à—Ä—É—Ç–µ —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Ç–æ –∑–∞–ø—Ä–æ—Å –∫ upload –≤–∏—Å–∏—Ç –¥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏. –ï—Å–ª–∏ –∑–∞–≤–æ–¥–∏—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ—ë - –∑–∞–≤–∏—Å–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å. –í–æ–∑–º–æ–∂–Ω–æ, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—Å—ë-—Ç–∞–∫ —è–≤–ª—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏, –Ω–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª —Å–µ—Å—Å–∏—é)
